<div class="container">
  <section><h1>Publicar Productos</h1></section>

  <div class="container-create-post">
    <div class="section-1">
      <app-create-post-info-user-content class="section-info-contact"></app-create-post-info-user-content>

      <!-- Botón Publicar -->
      <button class="button-submit btn-desk"
              mat-stroked-button
              (click)="onPost()"
              [disabled]="loading || isBanned"
              [ngClass]="{ 'greyed': isBanned }">
        <div *ngIf="!loading">Publicar</div>
        <mat-spinner *ngIf="loading" diameter="20" style="margin-left: 8px;"></mat-spinner>
      </button>

      <!-- Mensaje de bloqueo -->
      <div *ngIf="isBanned" class="ban-msg">
        Publicación bloqueada por política.
        <span *ngIf="banRemainingMs > 0">Tiempo restante: {{ formatHms(banRemainingMs) }}</span>
        <span *ngIf="banRemainingMs === 0">Contacta soporte si crees que es un error.</span>
      </div>
    </div>

    <!-- Conectamos el signal de archivo (dos vías) -->
    <app-create-info-post-content
      class="section-info-post"
      [(selectedFile)]="selectedFile"
      [aiSuggestion]="aiSuggestion"
      [aiLoading]="aiLoading">
    </app-create-info-post-content>
  </div>

  <!-- Responsive -->
  <button class="button-submit btn-res"
          mat-stroked-button
          (click)="onPost()"
          [disabled]="loading || isBanned"
          [ngClass]="{ 'greyed': isBanned }">
    <div *ngIf="!loading">Publicar</div>
    <mat-spinner *ngIf="loading" diameter="20" style="margin-left: 8px;"></mat-spinner>
  </button>

</div>

<!-- ========================= -->
<!-- Overlay global de cargando IA -->
<!-- ========================= -->
<!-- Overlay global de cargando IA -->
<div class="global-loading" *ngIf="aiLoading" aria-busy="true" aria-live="assertive">
  <div class="global-loading__backdrop"></div>

  <div class="global-loading__card">
    <mat-spinner diameter="56" class="global-loading__spinner"></mat-spinner>
    <div class="global-loading__title">Analizando imagen con IA…</div>
    <div class="global-loading__sub">Esto puede tardar unos segundos</div>
  </div>
</div>
